
# 📌 最後 4 天衝刺題單（Google Storage/Infra L6）

## 🔹 Day -4（Coding 快手 + Infra 熱身）

### 題目：

1. **LC 146. LRU Cache (Medium)**

    * **對應**：cache eviction / memory 限制
    * 考驗 hash + doubly linked list，跟 **「memory 設限、4-byte register、FIFO vs LRU」** 有關
2. **LC 215. Kth Largest Element in an Array (Medium)**

    * **對應**：heap, scheduling, buffer priority
3. **LC 703. Kth Largest in a Stream (Easy)**

    * **對應**：stream buffer, online data structure

### Embedded Warm-up：

* 練習寫一個 **4-byte register bit 操作**：

  ```cpp
  inline void setBit(volatile uint32_t& reg, int pos) { reg |= (1u << pos); }
  inline void clearBit(volatile uint32_t& reg, int pos) { reg &= ~(1u << pos); }
  inline bool readBit(volatile uint32_t reg, int pos) { return (reg >> pos) & 1u; }
  ```

  👉 這正好對應人資 hint：**offset, operation, volatile, pointer**

---

## 🔹 Day -3（Concurrency 必考）

### 題目：

1. **LC 1114. Print in Order (Easy)**

    * **對應**：`mutex`, `condition_variable`，多執行緒順序控制
2. **LC 1115. Print FooBar Alternately (Medium)**

    * **對應**：semaphore, thread sync，考驗多線程交替
3. **自己手寫：Token Bucket Rate Limiter**（C++）

    * 用 `std::chrono + mutex`
    * **對應 hint**：**timer, calculate tick, IRQ 啟停**

### Embedded Warm-up：

* **FIFO buffer**：實作一個簡單 **circular queue**，用 `array + head/tail pointer`。
* 這題對應 hint：**FIFO, offset, MCU**（MCU 裡面 FIFO 常用於 UART buffer）。

---

## 🔹 Day -2（系統設計 Warm-up）

### 題目：

1. **LC 20. Valid Parentheses (Easy)** → 快速複習 stack 基礎
2. **系統設計題**：設計 **簡單 Rate Limiter**（token bucket）

    * 討論 **不同 bucket 大小 / timer tick**
    * 延伸到 **「I/O block、timer、IRQ 啟停」**
3. **系統設計題**：設計 **簡易分散式 Log Storage**

    * Metadata → leader election
    * Data shard → replication
    * **對應 hint**：**計算機組織 / 架構、I/O block、board support package**

---

## 🔹 Day -1（總複習 + Mock）

### Coding 隨機快題

* 抽 2 道 Easy（array/bit/linkedlist）+ 1 道 Medium（heap/LRU/stack queue）
  👉 模擬真實 coding round

### 系統設計 Mock

* 題目：「設計一個跨 data center 的 storage system」

    * 說明 **replication, consistency model, failover**
    * 引入 **memory 限制、timer tick、critical session（什麼時候要 disable IRQ 以保證一致性）**

### 行為題 Mock

* 用 **STAR** 準備 3 個故事（跨部門合作、解決 infra bottleneck、失敗與改進）。

---

# 📌 你要會講的 Embedded / Infra 心法（照人資 hint 條列）

* **offset, operation, pointer, volatile**
  → 記憶體位址運算 + register 操作
* **mutex, multi-thread**
  → C++ `std::mutex`, `lock_guard`，以及為何要避免死鎖
* **board support package (BSP)**
  → OS 與硬體之間的抽象層（driver, bootloader, config）
* **計算機組織 / 架構**
  → memory hierarchy (register → cache → DRAM → disk)，storage latency gap
* **I/O block**
  → block device vs character device；storage system buffer size
* **MCU**
  → microcontroller，低功耗單晶片（和 general CPU 差異）
* **FIFO**
  → ring buffer，用於 UART / DMA buffer
* **4 byte register, memory 限制**
  → embedded system register 常用 32-bit boundary
* **硬體設限**
  → buffer size, register bitwidth, DMA alignment
* **timer, tick**
  → 計時器中斷，scheduler tick
* **critical session / IRQ 啟停**
  → 當操作 shared register / buffer 時，要 disable IRQ 保護臨界區
* **workflow & design**
  → embedded system 設計流程：MCU → BSP → driver → OS → application

---

✅ 總結：
你的刷題清單已經夠「量」，現在補上 **Concurrency + Heap/Cache + 系統設計**，並且準備好人資 hint 裡的 embedded/infra 心法。這樣最後 4 天就能高效衝刺到 **L6 應有的水準**。

---

要不要我幫你把這份 **最後 4 天衝刺題單 + Embedded 心法** 做成一個 **Notion-friendly Markdown**，讓你每天照表操課？


好的 👍 我幫你整理一張 **Flags 位元操作小抄表格**，這就是面試常考的「四大操作」：

---

# 🌟 Bit Flags Cheat Sheet (C++)

假設：

```cpp
uint32_t perm = 0;            // 權限集合
const uint32_t READ  = 1u<<0; // 0001
const uint32_t WRITE = 1u<<1; // 0010
const uint32_t EXEC  = 1u<<2; // 0100
```

| 操作                        | 程式寫法                 | 解釋           | 範例結果                      |             |
| ------------------------- | -------------------- | ------------ | ------------------------- | ----------- |
| **Set (設置某 flag)**        | `perm                | = READ;`     | 把第 0 位設為 1                | 0000 → 0001 |
| **Clear (清除某 flag)**      | `perm &= ~WRITE;`    | 把第 1 位清成 0   | 0110 → 0100               |             |
| **Toggle (翻轉某 flag)**     | `perm ^= EXEC;`      | 若有則關，若無則開    | 0100 → 0000 / 0000 → 0100 |             |
| **Check (檢查某 flag 是否存在)** | `(perm & READ) != 0` | 判斷第 0 位是否為 1 | 0011 → true               |             |

---

# 📌 延伸補充

* **同時設多個 flag**

  ```cpp
  perm |= (READ | EXEC);  // 一次加上 R 和 X
  ```
* **同時清多個 flag**

  ```cpp
  perm &= ~(READ | WRITE);  // 清掉 R 和 W
  ```
* **快速判斷「是否只有一個 flag」**

  ```cpp
  if (perm && (perm & (perm - 1)) == 0) { ... } 
  // true → 只有一個 bit 被設置
  ```

---

✅ 面試官要看的是：

1. 你會不會用「位運算」做狀態集合管理。
2. 你能不能口述出來：「這是 set/clear/toggle/check」。

---

要不要我再幫你整理一份 **「真實系統場景」版的小抄**（例如檔案系統 R/W/X 權限、Cloud storage block metadata flags），這樣你能在面試時舉出實際例子？
